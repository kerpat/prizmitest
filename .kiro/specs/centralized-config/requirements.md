# Requirements Document

## Introduction

Проект GoGoBike содержит множество захардкоженных конфигурационных значений (URL Supabase, API ключи, URL сервисов и т.д.), разбросанных по всем файлам проекта. Это создает проблемы при развертывании, тестировании и поддержке. Необходимо централизовать всю конфигурацию в единые файлы, чтобы разработчик мог легко менять настройки в одном месте.

## Requirements

### Requirement 1: Централизованная конфигурация для фронтенда

**User Story:** Как разработчик, я хочу иметь единый конфигурационный файл для фронтенда, чтобы не искать и не менять URL и ключи в каждом файле отдельно.

#### Acceptance Criteria

1. WHEN разработчик открывает проект THEN он должен найти единый файл конфигурации для всех фронтенд-файлов
2. WHEN разработчик меняет значение в конфигурационном файле THEN все файлы фронтенда должны использовать новое значение
3. IF файл `site/config.js` уже существует THEN он должен быть расширен для покрытия всех необходимых параметров
4. WHEN конфигурация загружается THEN она должна быть доступна глобально через `window.APP_CONFIG`

### Requirement 2: Централизованная конфигурация для бэкенда (API)

**User Story:** Как разработчик, я хочу использовать переменные окружения для всех API-эндпоинтов, чтобы не хардкодить значения в коде.

#### Acceptance Criteria

1. WHEN API-файл запускается THEN он должен читать все конфигурационные значения из `process.env`
2. WHEN в коде есть захардкоженный URL THEN он должен быть заменен на переменную окружения
3. IF переменная окружения отсутствует THEN должна быть выведена понятная ошибка с указанием, какая переменная нужна
4. WHEN разработчик обновляет `.env` файл THEN изменения должны применяться после перезапуска сервиса

### Requirement 3: Централизованная конфигурация для Python бота

**User Story:** Как разработчик, я хочу, чтобы Python бот использовал переменные окружения для всех настроек, чтобы легко менять конфигурацию.

#### Acceptance Criteria

1. WHEN бот запускается THEN он должен читать все настройки из переменных окружения
2. WHEN в коде бота есть захардкоженное значение THEN оно должно быть заменено на переменную окружения
3. IF критическая переменная отсутствует THEN бот должен выдать ошибку и не запускаться
4. WHEN разработчик меняет `.env` THEN изменения применяются после перезапуска бота

### Requirement 4: Документация конфигурации

**User Story:** Как новый разработчик, я хочу видеть документацию со всеми доступными конфигурационными параметрами, чтобы быстро настроить проект.

#### Acceptance Criteria

1. WHEN разработчик открывает проект THEN он должен найти файл с описанием всех конфигурационных параметров
2. WHEN параметр добавляется в конфигурацию THEN он должен быть задокументирован
3. IF параметр обязательный THEN это должно быть явно указано в документации
4. WHEN разработчик читает документацию THEN он должен понимать, для чего нужен каждый параметр

### Requirement 5: Обратная совместимость

**User Story:** Как разработчик, я хочу, чтобы существующий функционал продолжал работать после рефакторинга конфигурации.

#### Acceptance Criteria

1. WHEN конфигурация централизована THEN все существующие функции должны работать без изменений
2. WHEN файл использует старый способ доступа к конфигурации THEN он должен быть обновлен на новый способ
3. IF в HTML-файлах есть встроенные скрипты с конфигурацией THEN они должны использовать `window.APP_CONFIG`
4. WHEN все файлы обновлены THEN не должно остаться захардкоженных значений

### Requirement 6: Разделение конфигурации по окружениям

**User Story:** Как DevOps инженер, я хочу иметь возможность использовать разные конфигурации для development, staging и production окружений.

#### Acceptance Criteria

1. WHEN проект развертывается THEN должна использоваться конфигурация соответствующего окружения
2. WHEN создается новое окружение THEN должен быть пример конфигурационного файла
3. IF используется `.env` файл THEN должен существовать `.env.example` с описанием всех переменных
4. WHEN разработчик клонирует проект THEN он должен скопировать `.env.example` в `.env` и заполнить значения
